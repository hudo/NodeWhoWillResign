{"filter":false,"title":"replaceStream.js","tooltip":"/learning/streams/replaceStream.js","undoManager":{"mark":44,"position":44,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":0,"column":13},"action":"insert","lines":["replaceStream"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":0,"column":13},"action":"remove","lines":["replaceStream"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":8,"column":47},"action":"insert","lines":["var stream = require('stream');","var util = require('util');","function ReplaceStream(searchString, replaceString) {","stream.Transform.call(this, {decodeStrings: false});","this.searchString = searchString;","this.replaceString = replaceString;","this.tailPiece = '';","}","util.inherits(ReplaceStream, stream.Transform);"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":3,"column":0},"action":"insert","lines":["",""]},{"start":{"row":4,"column":0},"end":{"row":4,"column":4},"action":"insert","lines":["    "]},{"start":{"row":4,"column":33},"end":{"row":5,"column":8},"action":"insert","lines":["","        "]},{"start":{"row":5,"column":28},"end":{"row":6,"column":4},"action":"insert","lines":["","    "]},{"start":{"row":7,"column":0},"end":{"row":7,"column":4},"action":"insert","lines":["    "]},{"start":{"row":8,"column":0},"end":{"row":8,"column":4},"action":"insert","lines":["    "]},{"start":{"row":9,"column":0},"end":{"row":9,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":11,"column":47},"end":{"row":12,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":0},"end":{"row":13,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":0},"end":{"row":23,"column":1},"action":"insert","lines":["ReplaceStream.prototype._transform = function(chunk, encoding,","callback) {","var pieces = (this.tailPiece + chunk) //[1]",".split(this.searchString);","var lastPiece = pieces[pieces.length - 1];","var tailPieceLen = this.searchString.length - 1;","this.tailPiece = lastPiece.slice(-tailPieceLen); //[2]","pieces[pieces.length - 1] = lastPiece.slice(0, -tailPieceLen);","this.push(pieces.join(this.replaceString)); //[3]","callback();","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":0},"end":{"row":14,"column":4},"action":"insert","lines":["    "]},{"start":{"row":15,"column":0},"end":{"row":15,"column":4},"action":"insert","lines":["    "]},{"start":{"row":16,"column":0},"end":{"row":16,"column":8},"action":"insert","lines":["        "]},{"start":{"row":17,"column":0},"end":{"row":17,"column":4},"action":"insert","lines":["    "]},{"start":{"row":18,"column":0},"end":{"row":18,"column":4},"action":"insert","lines":["    "]},{"start":{"row":19,"column":0},"end":{"row":19,"column":4},"action":"insert","lines":["    "]},{"start":{"row":20,"column":0},"end":{"row":20,"column":4},"action":"insert","lines":["    "]},{"start":{"row":21,"column":0},"end":{"row":21,"column":4},"action":"insert","lines":["    "]},{"start":{"row":22,"column":0},"end":{"row":22,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":62},"end":{"row":14,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":62},"end":{"row":13,"column":63},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":62},"end":{"row":13,"column":63},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":62},"end":{"row":13,"column":63},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":62},"end":{"row":13,"column":63},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":62},"end":{"row":13,"column":63},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":46},"end":{"row":14,"column":47},"action":"remove","lines":["]"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":45},"end":{"row":14,"column":46},"action":"remove","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":44},"end":{"row":14,"column":45},"action":"remove","lines":["["]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":43},"end":{"row":14,"column":44},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":42},"end":{"row":14,"column":43},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":15,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":14,"column":41},"end":{"row":14,"column":42},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":57},"end":{"row":17,"column":58},"action":"remove","lines":["]"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":56},"end":{"row":17,"column":57},"action":"remove","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":55},"end":{"row":17,"column":56},"action":"remove","lines":["["]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":54},"end":{"row":17,"column":55},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":53},"end":{"row":17,"column":54},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":52},"end":{"row":17,"column":53},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":52},"end":{"row":19,"column":53},"action":"remove","lines":["]"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":51},"end":{"row":19,"column":52},"action":"remove","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":50},"end":{"row":19,"column":51},"action":"remove","lines":["["]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":49},"end":{"row":19,"column":50},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":48},"end":{"row":19,"column":49},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":47},"end":{"row":19,"column":48},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":1},"end":{"row":22,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":0},"end":{"row":23,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":0},"end":{"row":27,"column":31},"action":"insert","lines":["ReplaceStream.prototype._flush = function(callback) {","this.push(this.tailPiece);","callback();","}","module.exports = ReplaceStream;"]}]}],[{"group":"doc","deltas":[{"start":{"row":24,"column":0},"end":{"row":24,"column":4},"action":"insert","lines":["    "]},{"start":{"row":25,"column":0},"end":{"row":25,"column":4},"action":"insert","lines":["    "]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":9,"column":9},"end":{"row":9,"column":18},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1427462820124,"hash":"0255eec73988df4cb151b97b8534c27f8e7671c7"}